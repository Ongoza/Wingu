<!--
    TODO
        
        текущая информация о системе:
                       процессор: температура, процессора по ядрам
                       видеокарты: для каждой температура, загрузка, вентилятор, питание,
                       диск: свободное место
                       видеопотоки: сколько обрабатывается
        история изменения с нанесенными событиями (остановка включение видеоптоков, алерты)
    -->
<html>
<head>
    <meta charset="UTF-8">
    <title>"Wingu"</title>
    <link rel="icon" type="image/png" href="lib/favicon.png">
    <script src="lib/jquery-3.5.1.min.js"></script>
    <link href="lib/bootstrap.min.css" rel="stylesheet">
    <link href="lib/flag-icon.min.css" rel="stylesheet">
    <script src="lib/bootstrap.min.js"></script>
    <script src="lib/moment.min.js"></script>
    <script src="lib/daterangepicker.js"></script>
    <link rel="stylesheet" href="lib/daterangepicker.css">
    <link rel="stylesheet" href="lib/uPlot.min.css">
    <script src="lib/uPlot.iife.min.js"></script>
    <link rel="stylesheet" type="text/css" href="lib/jquery.dataTables.min.css" />
    <script type="text/javascript" src="lib/datatables.min.js"></script>

    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.1.0/css/flag-icon.min.css" rel="stylesheet">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script> -->
    <!-- <script src="js/websocket.js"></script> -->
    <script src="js/websocket.js"></script>
    <script src="js/nav.js"></script>
    <script>

        const transpose = (matrix) => {
            let [row] = matrix;
            let res = row.map((value, column) => matrix.map(row => { return row[column]; }));
            return res;
        }


        let opts = {
            title: "Default",
            id: "visualization",
            class: "my-chart",
            width: 1000,
            height: 300,
            series: [
                {},
                {
                    label: "CPU",
                    stroke: "green",
                    width: 2,
                    scale: "%",
                    value: (self, rawValue) => rawValue.toFixed(0) + "%",
                },
                {
                    label: "RAM",
                    value: (self, rawValue) => rawValue.toFixed(0) + "%",
                    scale: "%",
                    stroke: "red",
                    width: 2,
                }
            ],
            axes: [
                {},
                {
                    scale: "%",
                    values: (self, ticks) => ticks.map(rawValue => rawValue.toFixed(0) + "%"),
                },
            ],
        };
        function updateViewOk(data) {
            // console.log("ok", data);
        }

        function configViewUpdate(typeConfig) {

        }
        function getServerData() {
            //console.log("items_gpu", items_cpu, items_gpu)

            // for (var i = 1; i < data2.length; i += 2) { items_gpu.push([data2[i][3], data2[i][1], data2[i][2]]); }
            // let fe = data2.map(k => k.filter(e => e.text == 'ZEC'));
            // let items_cpu = [items_cpu[3], items_cpu[1], items_cpu[2]];

            //console.log('camsSelected()', items_cpu);
            //var items = [
            //    [1546300000, 1546400000, 1546500000, 1546600000, 1546700000, 1546800000],    // x-values (timestamps)
            //    [35, 71, 21, 41, 11, 51],    // y-values (series 1)
            //    [90, 15, 30, 12, 69, 33],    // y-values (series 2)
            //];
            // console.log("data2", data2)

             $('#visualization').empty();
            let request = {};
            let t = $('#tableStat').DataTable();
            t.clear().draw();
            // var container = $('#visualization').append('<div></div>').attr('id', 'containerVis');
            request['time_start'] = $('#queue_timeRange').data('daterangepicker').startDate.unix()
            request['time_end'] = $('#queue_timeRange').data('daterangepicker').endDate.unix()
            //let index = 0;
            //let deviceList = ['cpu', '/GPU:0', '/GPU:1']
            //let typesList = ['_Load', '_Mem', '_Temp', '_Cams']
            //for (var i in deviceList) {
            //    for (var j in typesList) {
            //        groups.add({ id: index, content: deviceList[i] + typesList[j], options: { drawPoints: { style: 'square' }, } });
            //        index++;
            //    }
            //}
             console.log("post request", request);
            $.post("../statsHardJson", JSON.stringify(request), function (ans) {
                let json = JSON.parse(ans);
                $('#spinner').remove();
                if (json.hasOwnProperty('getStatsHard')) {
                    //let data = json['getStatsHard']
                    // console.log("data ready", data);
                    let data = [[6723, "cpu", 7, 35, 46, 3, 1613045009], [6724, "/GPU:0", 0, 0, 50, 3, 1613045009], [6725, "cpu", 9, 36, 46, 3, 1613045309], [6726, "/GPU:0", 0, 0, 51, 3, 1613045309], [6727, "cpu", 12, 36, 46, 3, 1613045609], [6728, "/GPU:0", 0, 0, 50, 3, 1613045609], [6729, "cpu", 8, 36, 46, 3, 1613045909], [6730, "/GPU:0", 0, 0, 50, 3, 1613045909], [6731, "cpu", 9, 36, 46, 3, 1613046210], [6732, "/GPU:0", 0, 0, 50, 3, 1613046210], [6733, "cpu", 13, 36, 46, 3, 1613046510], [6734, "/GPU:0", 10, 5, 50, 3, 1613046510], [6735, "cpu", 18, 36, 45, 3, 1613046811], [6736, "/GPU:0", 0, 0, 50, 3, 1613046811], [6737, "cpu", 18, 36, 45, 3, 1613047111], [6738, "/GPU:0", 0, 0, 50, 3, 1613047111], [6739, "cpu", 15, 36, 45, 3, 1613047411], [6740, "/GPU:0", 0, 0, 50, 3, 1613047411], [6741, "cpu", 9, 36, 45, 3, 1613047712], [6742, "/GPU:0", 0, 0, 50, 3, 1613047712], [6743, "cpu", 12, 35, 45, 3, 1613048012], [6744, "/GPU:0", 0, 0, 50, 3, 1613048012], [6745, "cpu", 8, 35, 45, 3, 1613048313], [6746, "/GPU:0", 0, 0, 50, 3, 1613048313], [6747, "cpu", 7, 36, 46, 3, 1613048613], [6748, "/GPU:0", 6, 3, 50, 3, 1613048613], [6749, "cpu", 6, 36, 46, 3, 1613048913], [6750, "/GPU:0", 0, 0, 50, 3, 1613048913], [6751, "cpu", 14, 36, 45, 3, 1613049213], [6752, "/GPU:0", 0, 0, 50, 3, 1613049213], [6753, "cpu", 18, 36, 45, 3, 1613049513], [6754, "/GPU:0", 0, 0, 49, 3, 1613049513], [6755, "cpu", 9, 35, 45, 3, 1613049813], [6756, "/GPU:0", 1, 0, 49, 3, 1613049813], [6757, "cpu", 6, 35, 45, 3, 1613050113], [6758, "/GPU:0", 0, 0, 49, 3, 1613050113], [6759, "cpu", 6, 36, 45, 3, 1613050413], [6760, "/GPU:0", 0, 0, 49, 3, 1613050413], [6761, "cpu", 5, 36, 46, 3, 1613050714], [6762, "/GPU:0", 0, 0, 50, 3, 1613050714], [6763, "cpu", 5, 35, 46, 3, 1613051014], [6764, "/GPU:0", 0, 0, 50, 3, 1613051014], [6765, "cpu", 7, 36, 47, 3, 1613051314], [6766, "/GPU:0", 0, 0, 50, 3, 1613051314], [6767, "cpu", 7, 36, 47, 3, 1613051614], [6768, "/GPU:0", 0, 0, 50, 3, 1613051614], [6769, "cpu", 6, 35, 47, 3, 1613051914], [6770, "/GPU:0", 0, 0, 51, 3, 1613051914], [6771, "cpu", 5, 36, 47, 3, 1613052214], [6772, "/GPU:0", 0, 0, 50, 3, 1613052214], [6773, "cpu", 5, 36, 47, 3, 1613052515], [6774, "/GPU:0", 0, 0, 50, 3, 1613052515], [6775, "cpu", 5, 36, 47, 3, 1613052815], [6776, "/GPU:0", 0, 0, 50, 3, 1613052815], [6777, "cpu", 6, 35, 47, 3, 1613053115], [6778, "/GPU:0", 0, 0, 50, 3, 1613053115], [6779, "cpu", 8, 35, 47, 3, 1613053415], [6780, "/GPU:0", 0, 0, 50, 3, 1613053415], [6781, "cpu", 7, 35, 47, 3, 1613053716], [6782, "/GPU:0", 0, 0, 50, 3, 1613053716], [6783, "cpu", 8, 35, 47, 3, 1613054016], [6784, "/GPU:0", 0, 0, 50, 3, 1613054016], [6785, "cpu", 5, 35, 47, 3, 1613054316], [6786, "/GPU:0", 0, 0, 50, 3, 1613054316], [6787, "cpu", 6, 35, 47, 3, 1613054616], [6788, "/GPU:0", 0, 0, 50, 3, 1613054616], [6789, "cpu", 7, 35, 47, 3, 1613054917], [6790, "/GPU:0", 0, 0, 50, 3, 1613054917], [6791, "cpu", 5, 35, 47, 3, 1613055217], [6792, "/GPU:0", 0, 0, 50, 3, 1613055217], [6793, "cpu", 5, 35, 47, 3, 1613055517], [6794, "/GPU:0", 0, 0, 50, 3, 1613055517], [6795, "cpu", 5, 35, 47, 3, 1613055817], [6796, "/GPU:0", 0, 0, 50, 3, 1613055817], [6797, "cpu", 7, 35, 47, 3, 1613056118], [6798, "/GPU:0", 0, 0, 50, 3, 1613056118], [6799, "cpu", 5, 35, 47, 3, 1613056418], [6800, "/GPU:0", 0, 0, 50, 3, 1613056418], [6801, "cpu", 6, 35, 47, 3, 1613056718], [6802, "/GPU:0", 0, 0, 50, 3, 1613056718], [6803, "cpu", 5, 35, 47, 3, 1613057018], [6804, "/GPU:0", 0, 0, 50, 3, 1613057018], [6805, "cpu", 6, 35, 47, 3, 1613057318], [6806, "/GPU:0", 0, 0, 51, 3, 1613057318], [6807, "cpu", 4, 35, 47, 3, 1613057618], [6808, "/GPU:0", 0, 0, 50, 3, 1613057618], [6809, "cpu", 6, 35, 47, 3, 1613057919], [6810, "/GPU:0", 0, 0, 50, 3, 1613057919], [6811, "cpu", 9, 35, 47, 3, 1613058219], [6812, "/GPU:0", 0, 0, 50, 3, 1613058219], [6813, "cpu", 5, 35, 47, 3, 1613058519], [6814, "/GPU:0", 3, 2, 50, 3, 1613058519], [6815, "cpu", 4, 35, 47, 3, 1613058819], [6816, "/GPU:0", 0, 0, 51, 3, 1613058819], [6817, "cpu", 5, 35, 47, 3, 1613059119], [6818, "/GPU:0", 0, 0, 50, 3, 1613059119], [6819, "cpu", 5, 36, 47, 3, 1613059419], [6820, "/GPU:0", 0, 0, 51, 3, 1613059419], [6821, "cpu", 7, 36, 47, 3, 1613059720], [6822, "/GPU:0", 0, 0, 50, 3, 1613059720], [6823, "cpu", 7, 36, 47, 3, 1613060020], [6824, "/GPU:0", 0, 0, 50, 3, 1613060020], [6825, "cpu", 7, 36, 47, 3, 1613060321], [6826, "/GPU:0", 0, 0, 50, 3, 1613060321], [6827, "cpu", 6, 36, 47, 3, 1613060621], [6828, "/GPU:0", 0, 0, 50, 3, 1613060621], [6829, "cpu", 5, 35, 47, 3, 1613060921], [6830, "/GPU:0", 0, 0, 51, 3, 1613060921], [6831, "cpu", 5, 35, 47, 3, 1613061221], [6832, "/GPU:0", 0, 0, 51, 3, 1613061221], [6833, "cpu", 7, 36, 47, 3, 1613061522], [6834, "/GPU:0", 0, 0, 50, 3, 1613061522], [6835, "cpu", 5, 36, 47, 3, 1613061822], [6836, "/GPU:0", 0, 0, 51, 3, 1613061822], [6837, "cpu", 4, 36, 47, 3, 1613062122], [6838, "/GPU:0", 0, 0, 50, 3, 1613062122], [6839, "cpu", 7, 36, 47, 3, 1613062423], [6840, "/GPU:0", 0, 0, 50, 3, 1613062423], [6841, "cpu", 6, 36, 47, 3, 1613062723], [6842, "/GPU:0", 0, 0, 51, 3, 1613062723], [6843, "cpu", 9, 36, 47, 3, 1613063023], [6844, "/GPU:0", 0, 0, 50, 3, 1613063023], [6845, "cpu", 7, 36, 47, 3, 1613063323], [6846, "/GPU:0", 0, 0, 51, 3, 1613063323], [6847, "cpu", 6, 36, 47, 3, 1613063623], [6848, "/GPU:0", 0, 0, 51, 3, 1613063623], [6849, "cpu", 4, 36, 47, 3, 1613063924], [6850, "/GPU:0", 0, 0, 50, 3, 1613063924], [6851, "cpu", 5, 36, 47, 3, 1613064224], [6852, "/GPU:0", 0, 0, 50, 3, 1613064224], [6853, "cpu", 5, 36, 47, 3, 1613064524], [6854, "/GPU:0", 0, 0, 50, 3, 1613064524], [6855, "cpu", 4, 36, 47, 3, 1613064824], [6856, "/GPU:0", 0, 0, 50, 3, 1613064824], [6857, "cpu", 4, 36, 47, 3, 1613065124], [6858, "/GPU:0", 0, 0, 50, 3, 1613065124], [6859, "cpu", 6, 36, 47, 3, 1613065425], [6860, "/GPU:0", 0, 0, 50, 3, 1613065425], [6861, "cpu", 10, 36, 47, 3, 1613065725], [6862, "/GPU:0", 0, 0, 50, 3, 1613065725], [6863, "cpu", 7, 36, 47, 3, 1613066025], [6864, "/GPU:0", 0, 0, 50, 3, 1613066025], [6865, "cpu", 6, 36, 47, 3, 1613066326], [6866, "/GPU:0", 0, 0, 50, 3, 1613066326], [6867, "cpu", 6, 36, 47, 3, 1613066626], [6868, "/GPU:0", 0, 0, 50, 3, 1613066626], [6869, "cpu", 8, 36, 47, 3, 1613066926], [6870, "/GPU:0", 0, 0, 50, 3, 1613066926], [6871, "cpu", 5, 36, 47, 3, 1613067227], [6872, "/GPU:0", 0, 0, 50, 3, 1613067227], [6873, "cpu", 4, 36, 47, 3, 1613067527], [6874, "/GPU:0", 0, 0, 50, 3, 1613067527], [6875, "cpu", 5, 36, 47, 3, 1613067827], [6876, "/GPU:0", 0, 0, 50, 3, 1613067827], [6877, "cpu", 4, 36, 47, 3, 1613068128], [6878, "/GPU:0", 0, 0, 50, 3, 1613068128], [6879, "cpu", 4, 36, 47, 3, 1613068428], [6880, "/GPU:0", 1, 0, 50, 3, 1613068428], [6881, "cpu", 4, 36, 47, 3, 1613068728], [6882, "/GPU:0", 0, 0, 50, 3, 1613068728], [6883, "cpu", 4, 36, 47, 3, 1613069029], [6884, "/GPU:0", 0, 0, 50, 3, 1613069029], [6885, "cpu", 4, 36, 47, 3, 1613069329], [6886, "/GPU:0", 0, 0, 50, 3, 1613069329], [6887, "cpu", 6, 36, 47, 3, 1613069629], [6888, "/GPU:0", 0, 0, 50, 3, 1613069629], [6889, "cpu", 9, 36, 47, 3, 1613069929], [6890, "/GPU:0", 0, 0, 50, 3, 1613069929], [6891, "cpu", 5, 36, 47, 3, 1613070229], [6892, "/GPU:0", 0, 0, 50, 3, 1613070229], [6893, "cpu", 5, 36, 47, 3, 1613070530], [6894, "/GPU:0", 0, 0, 50, 3, 1613070530], [6895, "cpu", 9, 36, 47, 3, 1613070830], [6896, "/GPU:0", 0, 0, 50, 3, 1613070830], [6897, "cpu", 8, 36, 47, 3, 1613071130], [6898, "/GPU:0", 0, 0, 50, 3, 1613071130], [6899, "cpu", 11, 36, 47, 3, 1613071431], [6900, "/GPU:0", 0, 0, 50, 3, 1613071431], [6901, "cpu", 9, 36, 47, 3, 1613071731], [6902, "/GPU:0", 0, 0, 50, 3, 1613071731], [6903, "cpu", 4, 36, 47, 3, 1613072031], [6904, "/GPU:0", 0, 0, 51, 3, 1613072031], [6905, "cpu", 6, 36, 47, 3, 1613072331], [6906, "/GPU:0", 0, 0, 50, 3, 1613072331], [6907, "cpu", 8, 36, 47, 3, 1613072631], [6908, "/GPU:0", 0, 0, 50, 3, 1613072631], [6909, "cpu", 8, 36, 47, 3, 1613072931], [6910, "/GPU:0", 0, 0, 50, 3, 1613072931], [6911, "cpu", 9, 36, 47, 3, 1613073232], [6912, "/GPU:0", 0, 0, 50, 3, 1613073232], [6913, "cpu", 9, 36, 47, 3, 1613073532], [6914, "/GPU:0", 0, 0, 50, 3, 1613073532], [6915, "cpu", 9, 36, 47, 3, 1613073832], [6916, "/GPU:0", 0, 0, 50, 3, 1613073832], [6917, "cpu", 10, 36, 47, 3, 1613074133], [6918, "/GPU:0", 0, 0, 50, 3, 1613074133], [6919, "cpu", 11, 36, 47, 3, 1613074433], [6920, "/GPU:0", 0, 0, 51, 3, 1613074433], [6921, "cpu", 14, 36, 47, 3, 1613074733], [6922, "/GPU:0", 0, 0, 51, 3, 1613074733], [6923, "cpu", 16, 36, 47, 3, 1613075034], [6924, "/GPU:0", 0, 0, 50, 3, 1613075034], [6925, "cpu", 16, 36, 47, 3, 1613075334], [6926, "/GPU:0", 0, 0, 50, 3, 1613075334], [6927, "cpu", 16, 36, 46, 3, 1613075634], [6928, "/GPU:0", 0, 0, 50, 3, 1613075634], [6929, "cpu", 17, 36, 46, 3, 1613075935], [6930, "/GPU:0", 0, 0, 50, 3, 1613075935], [6931, "cpu", 16, 36, 46, 3, 1613076235], [6932, "/GPU:0", 0, 0, 50, 3, 1613076235], [6933, "cpu", 16, 36, 46, 3, 1613076535], [6934, "/GPU:0", 0, 0, 50, 3, 1613076535], [6935, "cpu", 16, 36, 46, 3, 1613076836], [6936, "/GPU:0", 0, 0, 50, 3, 1613076836], [6937, "cpu", 16, 36, 46, 3, 1613077136], [6938, "/GPU:0", 0, 0, 50, 3, 1613077136], [6939, "cpu", 16, 36, 46, 3, 1613077436], [6940, "/GPU:0", 0, 0, 50, 3, 1613077436], [6941, "cpu", 16, 35, 46, 3, 1613077736], [6942, "/GPU:0", 0, 0, 51, 3, 1613077736], [6943, "cpu", 16, 36, 46, 3, 1613078036], [6944, "/GPU:0", 0, 0, 50, 3, 1613078036], [6945, "cpu", 16, 36, 46, 3, 1613078336], [6946, "/GPU:0", 0, 0, 50, 3, 1613078336], [6947, "cpu", 16, 35, 47, 3, 1613078637], [6948, "/GPU:0", 0, 0, 50, 3, 1613078637], [6949, "cpu", 17, 36, 46, 3, 1613078937], [6950, "/GPU:0", 0, 0, 50, 3, 1613078937], [6951, "cpu", 16, 36, 46, 3, 1613079237], [6952, "/GPU:0", 0, 0, 50, 3, 1613079237], [6953, "cpu", 16, 36, 46, 3, 1613079537], [6954, "/GPU:0", 0, 0, 50, 3, 1613079537], [6955, "cpu", 17, 36, 46, 3, 1613079838], [6956, "/GPU:0", 0, 0, 50, 3, 1613079838], [6957, "cpu", 16, 36, 46, 3, 1613080138], [6958, "/GPU:0", 0, 0, 50, 3, 1613080138], [6959, "cpu", 17, 36, 46, 3, 1613080438], [6960, "/GPU:0", 10, 5, 50, 3, 1613080438], [6961, "cpu", 16, 36, 46, 3, 1613080738], [6962, "/GPU:0", 0, 0, 51, 3, 1613080738], [6963, "cpu", 16, 36, 46, 3, 1613081039], [6964, "/GPU:0", 0, 0, 50, 3, 1613081039], [6965, "cpu", 16, 36, 47, 3, 1613081339], [6966, "/GPU:0", 0, 0, 50, 3, 1613081339], [6967, "cpu", 16, 36, 46, 3, 1613081640], [6968, "/GPU:0", 0, 0, 50, 3, 1613081640], [6969, "cpu", 16, 36, 47, 3, 1613081940], [6970, "/GPU:0", 0, 0, 50, 3, 1613081940], [6971, "cpu", 17, 36, 46, 3, 1613082240], [6972, "/GPU:0", 0, 0, 51, 3, 1613082240], [6973, "cpu", 17, 36, 46, 3, 1613082540], [6974, "/GPU:0", 0, 0, 50, 3, 1613082540], [6975, "cpu", 17, 36, 46, 3, 1613082840], [6976, "/GPU:0", 0, 0, 50, 3, 1613082840], [6977, "cpu", 16, 36, 46, 3, 1613083140], [6978, "/GPU:0", 0, 0, 50, 3, 1613083140], [6979, "cpu", 17, 36, 46, 3, 1613083441], [6980, "/GPU:0", 0, 0, 50, 3, 1613083441], [6981, "cpu", 17, 36, 46, 3, 1613083741], [6982, "/GPU:0", 0, 0, 50, 3, 1613083741], [6983, "cpu", 17, 36, 46, 3, 1613084041], [6984, "/GPU:0", 0, 0, 50, 3, 1613084041], [6985, "cpu", 17, 36, 46, 3, 1613084342], [6986, "/GPU:0", 0, 0, 50, 3, 1613084342], [6987, "cpu", 17, 36, 46, 3, 1613084642], [6988, "/GPU:0", 0, 0, 50, 3, 1613084642], [6989, "cpu", 19, 36, 46, 3, 1613084942], [6990, "/GPU:0", 0, 0, 50, 3, 1613084942], [6991, "cpu", 18, 36, 46, 3, 1613085243], [6992, "/GPU:0", 0, 0, 50, 3, 1613085243], [6993, "cpu", 17, 36, 46, 3, 1613085543], [6994, "/GPU:0", 0, 0, 50, 3, 1613085543], [6995, "cpu", 17, 36, 46, 3, 1613085843], [6996, "/GPU:0", 0, 0, 50, 3, 1613085843], [6997, "cpu", 17, 36, 46, 3, 1613086143], [6998, "/GPU:0", 10, 5, 51, 3, 1613086143], [6999, "cpu", 17, 36, 46, 3, 1613086444], [7000, "/GPU:0", 0, 0, 50, 3, 1613086444], [7001, "cpu", 17, 36, 46, 3, 1613086744], [7002, "/GPU:0", 0, 0, 50, 3, 1613086744], [7003, "cpu", 17, 36, 46, 3, 1613087044], [7004, "/GPU:0", 0, 0, 50, 3, 1613087044], [7005, "cpu", 17, 36, 46, 3, 1613087345], [7006, "/GPU:0", 0, 0, 50, 3, 1613087345], [7007, "cpu", 17, 36, 46, 3, 1613087645], [7008, "/GPU:0", 0, 0, 50, 3, 1613087645], [7009, "cpu", 17, 36, 46, 3, 1613087946], [7010, "/GPU:0", 0, 0, 50, 3, 1613087946], [7011, "cpu", 17, 36, 46, 3, 1613088246], [7012, "/GPU:0", 0, 0, 50, 3, 1613088246], [7013, "cpu", 17, 36, 46, 3, 1613088546], [7014, "/GPU:0", 0, 0, 50, 3, 1613088546], [7015, "cpu", 17, 36, 46, 3, 1613088846], [7016, "/GPU:0", 10, 5, 51, 3, 1613088846], [7017, "cpu", 17, 36, 46, 3, 1613089146], [7018, "/GPU:0", 0, 0, 50, 3, 1613089146], [7019, "cpu", 17, 36, 46, 3, 1613089446], [7020, "/GPU:0", 0, 0, 50, 3, 1613089446], [7021, "cpu", 17, 36, 46, 3, 1613089746], [7022, "/GPU:0", 0, 0, 50, 3, 1613089746], [7023, "cpu", 17, 36, 46, 3, 1613090046], [7024, "/GPU:0", 0, 0, 50, 3, 1613090046], [7025, "cpu", 17, 36, 46, 3, 1613090346], [7026, "/GPU:0", 0, 0, 50, 3, 1613090346], [7027, "cpu", 17, 36, 46, 3, 1613090646], [7028, "/GPU:0", 0, 0, 50, 3, 1613090646], [7029, "cpu", 17, 36, 46, 3, 1613090947], [7030, "/GPU:0", 0, 0, 50, 3, 1613090947], [7031, "cpu", 18, 36, 46, 3, 1613091247], [7032, "/GPU:0", 0, 0, 50, 3, 1613091247], [7033, "cpu", 17, 36, 46, 3, 1613091547], [7034, "/GPU:0", 0, 0, 50, 3, 1613091547], [7035, "cpu", 17, 36, 46, 3, 1613091848], [7036, "/GPU:0", 0, 0, 50, 3, 1613091848], [7037, "cpu", 17, 36, 46, 3, 1613092148], [7038, "/GPU:0", 0, 0, 50, 3, 1613092148], [7039, "cpu", 18, 36, 46, 3, 1613092448], [7040, "/GPU:0", 0, 0, 50, 3, 1613092448], [7041, "cpu", 18, 36, 46, 3, 1613092749], [7042, "/GPU:0", 0, 0, 50, 3, 1613092749], [7043, "cpu", 18, 36, 46, 3, 1613093049], [7044, "/GPU:0", 10, 5, 50, 3, 1613093049], [7045, "cpu", 18, 36, 46, 3, 1613093349], [7046, "/GPU:0", 10, 5, 50, 3, 1613093349], [7047, "cpu", 18, 36, 46, 3, 1613093649], [7048, "/GPU:0", 0, 0, 50, 3, 1613093649], [7049, "cpu", 18, 36, 46, 3, 1613093949], [7050, "/GPU:0", 0, 0, 50, 3, 1613093949], [7051, "cpu", 18, 36, 46, 3, 1613094250], [7052, "/GPU:0", 0, 0, 50, 3, 1613094250], [7053, "cpu", 18, 36, 46, 3, 1613094550], [7054, "/GPU:0", 0, 0, 50, 3, 1613094550], [7055, "cpu", 18, 36, 46, 3, 1613094851], [7056, "/GPU:0", 0, 0, 50, 3, 1613094851], [7057, "cpu", 18, 36, 46, 3, 1613095151], [7058, "/GPU:0", 6, 4, 50, 3, 1613095151], [7059, "cpu", 18, 36, 46, 3, 1613095451], [7060, "/GPU:0", 0, 0, 50, 3, 1613095451], [7061, "cpu", 18, 36, 46, 3, 1613095751], [7062, "/GPU:0", 0, 0, 50, 3, 1613095751], [7063, "cpu", 18, 36, 46, 3, 1613096052], [7064, "/GPU:0", 0, 0, 50, 3, 1613096052], [7065, "cpu", 20, 36, 46, 3, 1613096352], [7066, "/GPU:0", 0, 0, 50, 3, 1613096352], [7067, "cpu", 19, 36, 46, 3, 1613096652], [7068, "/GPU:0", 4, 3, 50, 3, 1613096652], [7069, "cpu", 18, 36, 46, 3, 1613096953], [7070, "/GPU:0", 1, 0, 50, 3, 1613096953], [7071, "cpu", 18, 36, 46, 3, 1613097253], [7072, "/GPU:0", 0, 0, 50, 3, 1613097253], [7073, "cpu", 18, 36, 46, 3, 1613097553], [7074, "/GPU:0", 10, 5, 50, 3, 1613097553], [7075, "cpu", 18, 36, 46, 3, 1613097853], [7076, "/GPU:0", 0, 0, 50, 3, 1613097853], [7077, "cpu", 22, 36, 46, 3, 1613098154], [7078, "/GPU:0", 0, 0, 50, 3, 1613098154], [7079, "cpu", 20, 36, 46, 3, 1613098454], [7080, "/GPU:0", 0, 0, 50, 3, 1613098454], [7081, "cpu", 18, 36, 46, 3, 1613098755], [7082, "/GPU:0", 0, 0, 50, 3, 1613098755], [7083, "cpu", 18, 36, 46, 3, 1613099055], [7084, "/GPU:0", 0, 0, 50, 3, 1613099055], [7085, "cpu", 18, 36, 46, 3, 1613099356], [7086, "/GPU:0", 0, 0, 50, 3, 1613099356], [7087, "cpu", 18, 36, 46, 3, 1613099656], [7088, "/GPU:0", 0, 0, 50, 3, 1613099656], [7089, "cpu", 18, 36, 46, 3, 1613099956], [7090, "/GPU:0", 10, 5, 50, 3, 1613099956], [7091, "cpu", 18, 36, 46, 3, 1613100256], [7092, "/GPU:0", 0, 0, 50, 3, 1613100256], [7093, "cpu", 18, 36, 46, 3, 1613100557], [7094, "/GPU:0", 0, 0, 50, 3, 1613100557], [7095, "cpu", 18, 36, 46, 3, 1613100857], [7096, "/GPU:0", 0, 0, 50, 3, 1613100857], [7097, "cpu", 18, 36, 46, 3, 1613101157], [7098, "/GPU:0", 0, 0, 50, 3, 1613101157], [7099, "cpu", 19, 36, 46, 3, 1613101458], [7100, "/GPU:0", 0, 0, 50, 3, 1613101458], [7101, "cpu", 18, 36, 46, 3, 1613101758], [7102, "/GPU:0", 0, 0, 50, 3, 1613101758], [7103, "cpu", 18, 36, 46, 3, 1613102058], [7104, "/GPU:0", 0, 0, 50, 3, 1613102058], [7105, "cpu", 18, 36, 46, 3, 1613102358], [7106, "/GPU:0", 0, 0, 50, 3, 1613102358], [7107, "cpu", 18, 36, 46, 3, 1613102658], [7108, "/GPU:0", 0, 0, 50, 3, 1613102658], [7109, "cpu", 18, 36, 45, 3, 1613102959], [7110, "/GPU:0", 0, 0, 50, 3, 1613102959], [7111, "cpu", 18, 37, 45, 3, 1613103259], [7112, "/GPU:0", 0, 0, 50, 3, 1613103259], [7113, "cpu", 18, 37, 46, 3, 1613103559], [7114, "/GPU:0", 0, 0, 50, 3, 1613103559], [7115, "cpu", 18, 37, 45, 3, 1613103860], [7116, "/GPU:0", 0, 0, 50, 3, 1613103860], [7117, "cpu", 18, 37, 45, 3, 1613104160], [7118, "/GPU:0", 0, 0, 50, 3, 1613104160], [7119, "cpu", 18, 37, 46, 3, 1613104460], [7120, "/GPU:0", 10, 5, 50, 3, 1613104460], [7121, "cpu", 18, 37, 46, 3, 1613104761], [7122, "/GPU:0", 0, 0, 50, 3, 1613104761], [7123, "cpu", 18, 37, 46, 3, 1613105061], [7124, "/GPU:0", 0, 0, 50, 3, 1613105061], [7125, "cpu", 17, 37, 46, 3, 1613105361], [7126, "/GPU:0", 0, 0, 50, 3, 1613105361], [7127, "cpu", 17, 37, 45, 3, 1613105662], [7128, "/GPU:0", 0, 0, 50, 3, 1613105662], [7129, "cpu", 16, 37, 45, 3, 1613105962], [7130, "/GPU:0", 0, 0, 50, 3, 1613105962], [7131, "cpu", 15, 37, 45, 3, 1613106262], [7132, "/GPU:0", 0, 0, 50, 3, 1613106262], [7133, "cpu", 16, 37, 45, 3, 1613106562], [7134, "/GPU:0", 0, 0, 51, 3, 1613106562], [7135, "cpu", 17, 37, 45, 3, 1613106863], [7136, "/GPU:0", 0, 0, 50, 3, 1613106863], [7137, "cpu", 16, 37, 45, 3, 1613107163], [7138, "/GPU:0", 1, 0, 50, 3, 1613107163], [7139, "cpu", 18, 37, 45, 3, 1613107463], [7140, "/GPU:0", 0, 0, 50, 3, 1613107463], [7141, "cpu", 17, 37, 45, 3, 1613107763], [7142, "/GPU:0", 0, 0, 50, 3, 1613107763], [7143, "cpu", 17, 37, 45, 3, 1613108063], [7144, "/GPU:0", 0, 0, 50, 3, 1613108063], [7145, "cpu", 17, 37, 45, 3, 1613108364], [7146, "/GPU:0", 0, 0, 50, 3, 1613108364], [7147, "cpu", 16, 37, 45, 3, 1613108664], [7148, "/GPU:0", 0, 0, 50, 3, 1613108664], [7149, "cpu", 19, 37, 45, 3, 1613108964], [7150, "/GPU:0", 0, 0, 50, 3, 1613108964], [7151, "cpu", 19, 37, 45, 3, 1613109264], [7152, "/GPU:0", 0, 0, 50, 3, 1613109264], [7153, "cpu", 18, 37, 45, 3, 1613109564], [7154, "/GPU:0", 0, 0, 50, 3, 1613109564], [7155, "cpu", 15, 37, 45, 3, 1613109865], [7156, "/GPU:0", 0, 0, 50, 3, 1613109865], [7157, "cpu", 17, 37, 45, 3, 1613110165], [7158, "/GPU:0", 0, 0, 50, 3, 1613110165], [7159, "cpu", 16, 37, 45, 3, 1613110466], [7160, "/GPU:0", 0, 0, 50, 3, 1613110466], [7161, "cpu", 16, 37, 45, 3, 1613110766], [7162, "/GPU:0", 0, 0, 50, 3, 1613110766], [7163, "cpu", 15, 37, 45, 3, 1613111066], [7164, "/GPU:0", 0, 0, 50, 3, 1613111066], [7165, "cpu", 4, 37, 46, 3, 1613111367], [7166, "/GPU:0", 0, 0, 50, 3, 1613111367], [7167, "cpu", 5, 37, 46, 3, 1613111667], [7168, "/GPU:0", 0, 0, 50, 3, 1613111667], [7169, "cpu", 9, 37, 46, 3, 1613111967], [7170, "/GPU:0", 0, 0, 50, 3, 1613111967], [7171, "cpu", 7, 37, 46, 3, 1613112267], [7172, "/GPU:0", 0, 0, 50, 3, 1613112267], [7173, "cpu", 6, 37, 46, 3, 1613112568], [7174, "/GPU:0", 0, 0, 50, 3, 1613112568], [7175, "cpu", 7, 37, 46, 3, 1613112868], [7176, "/GPU:0", 0, 0, 50, 3, 1613112868], [7177, "cpu", 10, 37, 46, 3, 1613113168], [7178, "/GPU:0", 0, 0, 50, 3, 1613113168], [7179, "cpu", 9, 37, 46, 3, 1613113468], [7180, "/GPU:0", 0, 0, 50, 3, 1613113468], [7181, "cpu", 6, 37, 45, 3, 1613113768], [7182, "/GPU:0", 0, 0, 49, 3, 1613113768], [7183, "cpu", 9, 37, 45, 3, 1613114068], [7184, "/GPU:0", 0, 0, 50, 3, 1613114068], [7185, "cpu", 11, 37, 45, 3, 1613114368], [7186, "/GPU:0", 0, 0, 49, 3, 1613114368], [7187, "cpu", 12, 37, 45, 3, 1613114668], [7188, "/GPU:0", 0, 0, 50, 3, 1613114668], [7189, "cpu", 14, 37, 45, 3, 1613114968], [7190, "/GPU:0", 0, 0, 49, 3, 1613114968], [7191, "cpu", 17, 37, 45, 3, 1613115269], [7192, "/GPU:0", 1, 0, 49, 3, 1613115269], [7193, "cpu", 18, 37, 45, 3, 1613115569], [7194, "/GPU:0", 0, 0, 49, 3, 1613115569], [7195, "cpu", 21, 37, 44, 3, 1613115870], [7196, "/GPU:0", 0, 0, 49, 3, 1613115870], [7197, "cpu", 19, 37, 44, 3, 1613116170], [7198, "/GPU:0", 0, 0, 49, 3, 1613116170], [7199, "cpu", 20, 37, 44, 3, 1613116471], [7200, "/GPU:0", 0, 0, 49, 3, 1613116471], [7201, "cpu", 19, 37, 44, 3, 1613116771], [7202, "/GPU:0", 0, 0, 49, 3, 1613116771], [7203, "cpu", 17, 37, 44, 3, 1613117071], [7204, "/GPU:0", 0, 0, 49, 3, 1613117071], [7205, "cpu", 17, 37, 44, 3, 1613117372], [7206, "/GPU:0", 0, 0, 49, 3, 1613117372], [7207, "cpu", 17, 37, 44, 3, 1613117672], [7208, "/GPU:0", 0, 0, 49, 3, 1613117672], [7209, "cpu", 17, 37, 45, 3, 1613117973], [7210, "/GPU:0", 0, 0, 50, 3, 1613117973], [7211, "cpu", 17, 37, 45, 3, 1613118273], [7212, "/GPU:0", 0, 0, 49, 3, 1613118273], [7213, "cpu", 18, 37, 45, 3, 1613118573], [7214, "/GPU:0", 0, 0, 49, 3, 1613118573], [7215, "cpu", 15, 37, 45, 3, 1613118873], [7216, "/GPU:0", 1, 0, 50, 3, 1613118873], [7217, "cpu", 16, 37, 45, 3, 1613119174], [7218, "/GPU:0", 0, 0, 49, 3, 1613119174], [7219, "cpu", 10, 37, 45, 3, 1613119474], [7220, "/GPU:0", 0, 0, 49, 3, 1613119474], [7221, "cpu", 8, 37, 45, 3, 1613119774], [7222, "/GPU:0", 1, 0, 50, 3, 1613119774], [7223, "cpu", 11, 37, 46, 3, 1613120075], [7224, "/GPU:0", 0, 0, 50, 3, 1613120075], [7225, "cpu", 12, 37, 46, 3, 1613120375], [7226, "/GPU:0", 10, 5, 51, 3, 1613120375], [7227, "cpu", 18, 37, 46, 3, 1613120675], [7228, "/GPU:0", 0, 0, 50, 3, 1613120675], [7229, "cpu", 18, 37, 45, 3, 1613120975], [7230, "/GPU:0", 0, 0, 50, 3, 1613120975], [7231, "cpu", 17, 37, 45, 3, 1613121275], [7232, "/GPU:0", 0, 0, 50, 3, 1613121275], [7233, "cpu", 17, 37, 46, 3, 1613121576], [7234, "/GPU:0", 0, 0, 50, 3, 1613121576], [7235, "cpu", 17, 37, 45, 3, 1613121876], [7236, "/GPU:0", 0, 0, 50, 3, 1613121876], [7237, "cpu", 17, 37, 45, 3, 1613122176], [7238, "/GPU:0", 0, 0, 50, 3, 1613122176], [7239, "cpu", 17, 37, 45, 3, 1613122477], [7240, "/GPU:0", 0, 0, 50, 3, 1613122477], [7241, "cpu", 16, 37, 45, 3, 1613122777], [7242, "/GPU:0", 0, 0, 50, 3, 1613122777], [7243, "cpu", 18, 37, 45, 3, 1613123077], [7244, "/GPU:0", 0, 0, 50, 3, 1613123077], [7245, "cpu", 18, 37, 45, 3, 1613123377], [7246, "/GPU:0", 0, 0, 50, 3, 1613123377], [7247, "cpu", 18, 37, 45, 3, 1613123678], [7248, "/GPU:0", 0, 0, 49, 3, 1613123678], [7249, "cpu", 17, 37, 45, 3, 1613123978], [7250, "/GPU:0", 0, 0, 49, 3, 1613123978], [7251, "cpu", 17, 37, 45, 3, 1613124278], [7252, "/GPU:0", 0, 0, 49, 3, 1613124278], [7253, "cpu", 18, 37, 45, 3, 1613124578], [7254, "/GPU:0", 0, 0, 49, 3, 1613124578], [7255, "cpu", 18, 37, 45, 3, 1613124879], [7256, "/GPU:0", 0, 0, 49, 3, 1613124879], [7257, "cpu", 18, 37, 45, 3, 1613125179], [7258, "/GPU:0", 0, 0, 50, 3, 1613125179], [7259, "cpu", 17, 37, 45, 3, 1613125479], [7260, "/GPU:0", 0, 0, 49, 3, 1613125479], [7261, "cpu", 18, 37, 45, 3, 1613125779], [7262, "/GPU:0", 6, 4, 50, 3, 1613125779], [7263, "cpu", 17, 37, 45, 3, 1613126079], [7264, "/GPU:0", 10, 5, 50, 3, 1613126079], [7265, "cpu", 18, 37, 45, 3, 1613126380], [7266, "/GPU:0", 0, 0, 49, 3, 1613126380], [7267, "cpu", 18, 37, 45, 3, 1613126680], [7268, "/GPU:0", 0, 0, 49, 3, 1613126680], [7269, "cpu", 18, 37, 45, 3, 1613126981], [7270, "/GPU:0", 0, 0, 49, 3, 1613126981], [7271, "cpu", 18, 37, 45, 3, 1613127281], [7272, "/GPU:0", 0, 0, 49, 3, 1613127281], [7273, "cpu", 18, 38, 45, 3, 1613127581], [7274, "/GPU:0", 0, 0, 50, 3, 1613127581], [7275, "cpu", 18, 38, 46, 2, 1613127882], [7276, "/GPU:0", 0, 0, 50, 2, 1613127882], [7277, "cpu", 18, 38, 46, 2, 1613128183], [7278, "/GPU:0", 0, 0, 50, 2, 1613128183], [7279, "cpu", 2, 28, 46, 2, 1613128303], [7280, "/GPU:0", 25, 19, 49, 2, 1613128303], [7281, "cpu", 8, 32, 47, 2, 1613128603], [7282, "/GPU:0", 0, 0, 51, 2, 1613128603], [7283, "cpu", 11, 33, 47, 2, 1613128904], [7284, "/GPU:0", 0, 0, 51, 2, 1613128904], [7285, "cpu", 15, 34, 47, 2, 1613129204], [7286, "/GPU:0", 10, 5, 51, 2, 1613129204], [7287, "cpu", 15, 35, 47, 3, 1613129505], [7288, "/GPU:0", 0, 0, 50, 3, 1613129505], [7289, "cpu", 19, 36, 47, 2, 1613129806], [7290, "/GPU:0", 0, 0, 50, 2, 1613129806], [7291, "cpu", 16, 37, 47, 3, 1613130106], [7292, "/GPU:0", 0, 0, 50, 3, 1613130106], [7293, "cpu", 10, 37, 47, 3, 1613130406], [7294, "/GPU:0", 15, 8, 51, 3, 1613130406], [7295, "cpu", 12, 38, 47, 3, 1613130707], [7296, "/GPU:0", 0, 0, 50, 3, 1613130707], [7297, "cpu", 13, 38, 47, 3, 1613131007], [7298, "/GPU:0", 0, 0, 50, 3, 1613131007]];
                    console.time('start1');
                    let data_cpu = [];
                    let data_gpu = [];
                    for (var i = 0; i < data.length - 1; i++) {
                        data_cpu.push(data[i]);
                        i++;
                        data_gpu.push(data[i]);
                    }
                    let data2_cpu = transpose(data_cpu);
                    let data2_gpu = transpose(data_gpu);
                    console.timeEnd("start1");

                    let items_cpu = [data2_cpu[6], data2_cpu[2], data2_cpu[3]];
                    let items_gpu = [data2_gpu[6], data2_gpu[2], data2_gpu[3]];
                    console.time('start2');

                    console.timeEnd('start2');

                    console.time('startPlot');
                    opts['title'] = "CPU";
                    let uplot = new uPlot(opts, items_cpu, document.getElementById('visualization'));
                    console.timeEnd('startPlot');
                    opts['title'] = "GPU:0";
                    let uplot2 = new uPlot(opts, items_gpu, document.getElementById('visualization'));
                }
            }).fail(function () {
                $('#spinner').remove();
                $('#alertInfo').html('<div class="alert alert-danger" role="alert">Error load data from server!</div>');
                console.log("error get json");
            }, "json");
        }

        //$(window).load(function () {
        $(document).ready(function () {
            $('#tableStat').DataTable({
                select: true,
                columnDefs: [{
                    targets: [0],
                    orderData: [0, 1]
                }, {
                    targets: [1],
                    orderData: [1, 0]
                }, {
                    targets: [4],
                    orderData: [4, 0]
                }]
            });

            if (wsCmd == null) { WebSocketCmd(); }
            $('#queue_timeRange').daterangepicker({
                timePicker24Hour: true,
                ranges: {
                    '1 hour': [moment(), moment().subtract(1, 'hours')],
                    '2 hour': [moment(), moment().subtract(2, 'hours')],
                    '1 day': [moment(), moment().subtract(1, 'days')],
                    'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                    'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                    'This Month': [moment().startOf('month'), moment().endOf('month')],
                    'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                },
                timePicker: true,
                startDate: moment().startOf('hour').subtract(1, 'days'),
                endDate: moment().startOf('hour'),
                locale: { format: 'MM/DD HH:mm' }
            });

            getServerData();
        });
    </script>
</head>
<body>
    <div id="menu"></div>
    <h1 id="headMain"></h1>
    <div id="content">
        <div class="card">
            <div class="card-body">
                <div id="dbRequest">
                    <form>
                        <b>Request to Database for data </b>
                        <div class="input-group mb-auto">
                            <label for="exampleInputEmail1"></label>
                            <div class="input-group w-50">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">Date range</span>
                                </div>
                                <input type="text" class="form-control" name="datetimes" id="queue_timeRange" />
                            </div>

                            <!--<div class="input-group-prepend">
            <span class="input-group-text">Devices</span>
        </div>
        <select class="custom-select" id="addStream_device">
            <option selected value="0">Any</option>
            <option value="1">CPU</option>
            <option value="2">GPU:1</option>
            <option value="3">GPU:2</option>
        </select>
                -->
                            <!--<div class="input-group-prepend">
            <span class="input-group-text">Interval (min)</span>

            <select class="custom-select" id="addStream_interval">
                <option value="10">10</option>
                <option value="15">15</option>
                <option value="30">30</option>
                <option selected value="60">60</option>
                <option value="120">120</option>
                <option value="180">180</option>
            </select>
        </div>-->
                            <button type="button" class="btn btn-primary" onclick="getServerData();">Get data</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div id="visualization"></div>
        <div class="card-body">
            <table id="tableStat" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Device</th>
                        <th>Loading</th>
                        <th>Memory</th>
                        <th>Temp</th>
                        <th>Cameras</th>
                        <th>Time</th>
                    </tr>
                </thead>
            </table>
            <div class="d-flex justify-content-center" id="alertInfo">
                <div class="spinner-border" role="status" id="spinner">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
        </div>

    </div>
</body>
</html>