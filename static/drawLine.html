<html>
<head>

    <script>

        function change(){
            let LongLine = document.getElementById('LongLine');
            LongLine.setAttribute('y1', '100');
        }
    </script>
</head>
<body>

    <br>
    <p>fsdfsdfsdfsd</p>
    <br>
    <div style="width:500px;height:500px;position:relative;margin:0px;background-image:url('img/back.jpg');background-repeat:no-repeat;">
        <svg style="border:1px solid black;z-index:9;" width="500" height="500" viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg" onload="makeDraggable(evt)">
            <style>
                .static {
                    cursor: not-allowed;
                }

                .draggable {
                    cursor: move;
                }
            </style>

            <script type="text/javascript">
                <![CDATA[
                function makeDraggable(evt) {
                var LongLine,  LongLine2, startOrNot;
                var svg = evt.target;
                svg.addEventListener('mousedown', startDrag);
                svg.addEventListener('mousemove', drag);
                svg.addEventListener('mouseup', endDrag);
                svg.addEventListener('mouseleave', endDrag);
                svg.addEventListener('touchstart', startDrag);
                svg.addEventListener('touchmove', drag);
                svg.addEventListener('touchend', endDrag);
                svg.addEventListener('touchleave', endDrag);
                svg.addEventListener('touchcancel', endDrag);
                var selectedElement, offset, transform,
                bbox, minX, maxX, minY, maxY, confined;
                var boundaryX1 = 10.5;
                var boundaryX2 = 30;
                var boundaryY1 = 2.2;
                var boundaryY2 = 19.2;

                function getMousePosition(evt) {
                var CTM = svg.getScreenCTM();
                if (evt.touches) { evt = evt.touches[0]; }
                return {
                x: (evt.clientX - CTM.e) / CTM.a,
                y: (evt.clientY - CTM.f) / CTM.d
                };
                }

                function startDrag(evt) {
                if (evt.target.classList.contains('draggable')) {
                selectedElement = evt.target;
                let n = evt.target.id.lastIndexOf("_");
                console.log(evt.target.id.substring(0,n));
                let lineName = evt.target.id.substring(0,n);
                LongLine = document.getElementById(lineName);
                LongLine2 = document.getElementById(lineName+'1');
                selectedElement.id.includes("start") ? startOrNot = true : startOrNot = false;
                console.log("startOrNot",startOrNot);
                offset = getMousePosition(evt);
                var transforms = selectedElement.transform.baseVal;
                if (transforms.length === 0 || transforms.getItem(0).type !== SVGTransform.SVG_TRANSFORM_TRANSLATE) {
                var translate = svg.createSVGTransform();
                translate.setTranslate(0, 0);
                selectedElement.transform.baseVal.insertItemBefore(translate, 0);
                }
                transform = transforms.getItem(0);
                offset.x -= transform.matrix.e;
                offset.y -= transform.matrix.f;
                }
                }

                function drag(evt) {
                if (selectedElement) {
                evt.preventDefault();
                var coord = getMousePosition(evt);
                var dx = coord.x - offset.x;
                var dy = coord.y - offset.y;
                transform.setTranslate(dx, dy);
                let x1 = parseInt(LongLine.getAttribute('x1'));
                let y1 = parseInt(LongLine.getAttribute('y1'));
                let x2 = parseInt(LongLine.getAttribute('x2'));
                let y2 = parseInt(LongLine.getAttribute('y2'));
                let dx2 = x2-x1;
                let dy2 = y2-y1;
                let dx28 = Math.floor(dx2/16);
                let dy28 = Math.floor(dy2/16);
                if(dy2 == 0){ dy2 = 0.0001;}
                if(dx2 == 0){ dx2 = 0.0001;}
                if(startOrNot){
                LongLine.setAttribute('x1', coord.x);
                LongLine.setAttribute('y1', coord.y);
                LongLine2.setAttribute('x2', x2 - dy28);
                LongLine2.setAttribute('y2', y2 + dx28);
                LongLine2.setAttribute('x1', coord.x - dy28);
                LongLine2.setAttribute('y1', coord.y + dx28);
                }else{
                LongLine.setAttribute('x2', coord.x);
                LongLine.setAttribute('y2', coord.y);
                LongLine2.setAttribute('x1', x1 - dy28);
                LongLine2.setAttribute('y1', y1 + dx28);
                LongLine2.setAttribute('x2', coord.x - dy28);
                LongLine2.setAttribute('y2', coord.y + dx28);
                }


                // 0.785398163
                // console.log("dx2",  Math.ceil(Math.atan(dx2/dy2)* (180/Math.PI)));
                }
                }

                function endDrag(evt) {
                selectedElement = false;
                LongLine = null;
                LongLine2 = null;
                }
                }
                ]]></script>

            <line class="static" id="0_line" x1="200" y1="200" x2="100" y2="100" stroke-width="2" stroke="#00ff21" />
            <line class="static" id="0_line1" x1="200" y1="204" x2="100" y2="104" stroke-width="2" stroke="#ff0021" />
            <circle class="draggable" id="0_line_start" cx="200" cy="200" r="5" stroke="blue" stroke-width="1" fill="#00ff21" />
            <circle class="draggable" id="0_line_end" cx="100" cy="100" r="5" stroke="blue" stroke-width="1" fill="#ff0021" />

            <line class="static" id="1_line" x1="300" y1="300" x2="250" y2="400" stroke-width="2" stroke="#00ff21" />
            <line class="static" id="1_line1" x1="300" y1="304" x2="250" y2="404" stroke-width="2" stroke="#ff0021" />
            <circle class="draggable" id="1_line_start" cx="300" cy="300" r="5" stroke="blue" stroke-width="1" fill="#00ff21" />
            <circle class="draggable" id="1_line_end" cx="250" cy="400" r="5" stroke="blue" stroke-width="1" fill="#ff0021" />

        </svg></div>
    <a href="#" onclick="change();">Click</a>
</body>
</html>